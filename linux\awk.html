linux awk命令

awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本。
awk是行处理器: 相比较屏幕处理的优点，在处理庞大文件时不会出现内存溢出或是处理缓慢的问题，通常用来格式化文本信息
awk处理过程:
先执行BEGING，然后读取文件，读入有/n换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，0则表示所有域,1表示第一个域,$n表示第n个域,
随后开始执行模式所对应的动作action。接着开始读入第二条记录······直到所有的记录都读完，最后执行END操作

一、awk脚本的基本结构：

　　awk 'BEGIN{print "start"} pattern {commands} END{print "ends"}' file 
// 一个awk脚本通常由：BEGIN语句块、能够使用模式匹配的通用语句块、END语句块3部分组成，这三部分是可选的，任意一部分都可以不出现在脚本中
//通常是被单引号或双引号括住的

      例如： awk 'BEGIN{i=0}{i++}END{print i}' filename

　　　　　 awk "BEGIN{i=0}{i++}END{print i}" filename

二、awk的执行过程

       awk 'BEGIN {commands} pattern{commands}END{commands}' filename

　　 [1]第一步：执行BEGIN{commands} 语句块中的语句；

　　 [2]第二步：从文件或标准输入（stdin）读取一行，然后执行pattern{commands}语句块，它逐行扫描文件，第一行到最后一行重复这个过程，直到文件全部被读取完毕；

　　 [3]第三步：当读至输入流末尾时候，执行END{commands}语句块

       BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块。比如变量的初始化、打印输出表格的表头等语句通常可以写在BEGIN语句块中。

       END语句块在awk从输入流读取完所有的行之后执行，比如打印所有行的分析结果这类信息汇总都是在END语句块中完成。

三、awk内置变量

           [1]$n 是当前行的按照指定域分隔符（默认是空格或[TAB]]键）分割后的第n个字段，比如n为1 表示第1个字段，n为2表示第2个字段

　　　　[2]$0 则是记录了执行过程中当前行的文本内容

           [3]NF 每一行($0)拥有的字段总数

           [4]NR 目前awk所处理的"第几行"数据

           [5]FNR 表示当前所处理的文本内的"第几行"数据

           [6]FS 目前的域分割符号，可以通过FS字段指定文本的域分割符

           [7]OFS 输出字段的分割符（默认是一个空格）

　　        [8]ORS 输出的记录分割符（默认是一个换行）

           [9]ARGIND 命令行中处理的当前文件的位置（从1开始）

           [10]ARGC 命令行参数的数目

           [11]ARGV 命令行参数的数组

awk有许多内置变量用来设置环境信息
特殊要点:

~            匹配，与==相比不是精确比较
!~           不匹配，不精确比较
==         等于，必须全部相等，精确比较
!=           不等于，精确比较
&&　     逻辑与
||             逻辑或
+            匹配时表示1个或1个以上
/[0-9][0-9]+/   两个或两个以上数字
/[0-9][0-9]*/    一个或一个以上数字
FILENAME 文件名
-F'[:#/]'   定义三个分隔符

awk中同时提供了print和printf两种打印输出的函数。跟其他语言类似


awk编程

条件语句

#awk '{count++;print $0;} END{print "user count is ", count}' /etc/passwd

awk中的条件语句同样借鉴于C语言

详情请参考 https://www.gnu.org/software/gawk/manual/gawk.html




